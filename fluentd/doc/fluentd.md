# fluentd

## データの収集方法

fluentdは、いくつかデータを収集する方法が存在する。

- ログファイルのtailing
- ソケットファイルによるデータ受信

### tailing

nginxのログフォルダをfluentdが直接参照することでtailingを行わせる。  
docker環境でのコンテナ間でやり取りするなら、

- bindマウントを使って、ホスト経由でログを参照しあってもいい
- volumeマウントを使って、volume経由でログを参照しあってもいい

> 上記は、本質的には同じである。  
> bindマウントは、任意のパスでファイルを共有する。  
> volumeマウントは、Docker管理ディレクトリ（ホストにある）でファイルを共有する。  
> 共有パスがユーザー管理かシステム管理かの違いで、大きな技術的な差はない。

よくサイドカーなんて言われたりする。

### ソケット通信

fluentdロギングドライバを使ってTCP通信することができる。
Dockerにはfluentd用の専用ドライバが組み込まれていて、それを設定して使うことでも解決できる。

### 参考

- [Fluentd ロギング・ドライバ](https://docs.docker.jp/engine/admin/logging/fluentd.html)
